# –°–µ—Ä–≤–∏—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–°–µ—Ä–≤–∏—Å, —Ö—Ä–∞–Ω—è—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–µ–≥–º–µ–Ω—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω —Å–æ—Å—Ç–æ–∏—Ç (—Å–æ–∑–¥–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–µ–≥–º–µ–Ω—Ç)

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- PostgreSQL (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö)
- Docker (–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞)
- Swagger (–¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API)
- Gin (–≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫)
- pgx (–¥—Ä–∞–π–≤–µ—Ä —Ä–∞–±–æ—Ç—ã —Å PostgreSQL)
- golang/mock (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–°–µ—Ä–≤–∏—Å –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Clean Architecture, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –∫–∞–∫–∏–º-–ª–∏–±–æ –ø—Ä–æ–±–ª–µ–º–∞–º

# üîßGetting Started
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –ø–æ —à–∞–±–ª–æ–Ω—É .env.example

# üöÄ–ó–∞–ø—É—Å–∫ 

–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥—ã `make compose-up`

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø–æ –ø—É—Ç–∏ `http://localhost:8080/swagger/index.html` –¥–æ—Å—Ç—É–ø–µ–Ω swagger, –≥–¥–µ –æ–ø–∏—Å–∞–Ω—ã —Ä—É—á–∫–∏(–µ—Å–ª–∏ port –Ω–µ –±—ã–ª –∏–∑–º–µ–Ω—ë–Ω)

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–æ–π `make test`, –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º `make cover` –∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á—ë—Ç–∞ –≤ html —Ñ–æ—Ä–º–∞—Ç–µ `make cover-html` 

## Examples

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```curl
curl --location --request POST 'localhost:8080/segment/create' \
--header 'Content-Type: application/json' \
--data '{
    "slug": "AVITO_VOICE_MESSAGE",
    "autoJoinProcent": 100
}'
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: http-—Å—Ç–∞—Ç—É—Å –∫–æ–¥: 201(Created)

### –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞

–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```curl
curl --location --request DELETE 'localhost:8080/segment/delete' \
--header 'Content-Type: application/json' \
--data '{
    "slug": "AVITO_TECH"
}'
```
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: http-—Å—Ç–∞—Ç—É—Å –∫–æ–¥: 200(OK)

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ URL(userId))

```curl
curl --location --request GET 'localhost:8080/user/segment/getAllActive?userId=347'
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
{
    "userId": 31,
    "segments": [
        "AVITO_TECH",
        "AVITO_DISCOUNT_15",
        "AVITO_DISCOUNT_11",
        "AVITO_DISCOUNT_12",
        "AVITO_DISCOUNT_13"
    ]
}
```

### –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è —é–∑–µ—Ä–∞ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞

–ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç –¥–ª—è —é–∑–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ –º–∞—Å—Å–∏–≤–µ —Å–µ–≥–º–µ–Ω—Ç—ã. –ï—Å–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –æ—à–∏–±–∫–∞ —Å –º–∞—Å—Å–∏–≤–æ–º –æ—à–∏–±–æ—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
```curl
curl --location --request POST 'localhost:8080/user/segment/action' \
--header 'Content-Type: application/json' \
--data '{
    "userId": 347,
    "segmentsToAdd": ["AVITO_DISCOUNT_12"],
    "segmentsToRemove": ["AVITO_DISCOUNT_15"]
    
}'
```

–¢–∞–∫–∂–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –≤–∏–¥–µ –¥–∞—Ç—ã –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏(—Ñ–æ—Ä–º–∞—Ç–µ ISO 8601) –∂–∏–∑–Ω–∏ –¥–ª—è –≤—Å–µ—Ö –¥–æ–±–∞–≤–ª—è–µ–º—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤.
–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è:
```curl
curl --location --request POST 'localhost:8080/user/segment/action' \
--header 'Content-Type: application/json' \
--data '{
    "userId": 347,
    "segmentsToAdd": ["AVITO_DISCOUNT_12"],
    "segmentsToRemove": ["AVITO_DISCOUNT_15"],
    "expirationTime": "2023-08-31T22:18:10+03:00"
}'
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: http-—Å—Ç–∞—Ç—É—Å –∫–æ–¥: 200(OK)

### –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ –æ–¥–Ω–æ–º—É —é–∑–µ—Ä—É –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –º–µ—Å—è—Ü—É –∏ –≥–æ–¥—É

–ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CSV-—Ñ–∞–π–ª. –í URL –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –º–µ—Å—è—Ü, –≥–æ–¥ –∏ id —é–∑–µ—Ä–∞
```curl
curl --location --request GET 'localhost:8080/history/file?month=8&year=2023&userId=32123'
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: 
```json
{
    "url": "http://localhost:8080/./assets/csv_reports/0e666515-c657-4e49-b195-431c682563f7.csv"
}
```

## ü§î–ú–æ–∏ –≤–æ–ø—Ä–æ—Å—ã 
1. –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –¥–ª—è —é–∑–µ—Ä–∞ –ø—Ä–∏—à—ë–ª —Å–µ–≥–º–µ–Ω—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —É –Ω–µ–≥–æ —É–∂–µ –µ—Å—Ç—å?
   –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å, –∏–±–æ —Å–µ–≥–º–µ–Ω—Ç —É–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –í –∏—Å—Ç–æ—Ä–∏—é —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –Ω–µ –ø–æ–ø–∞–¥—ë—Ç
2. –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –¥–ª—è —é–∑–µ—Ä–∞ –ø—Ä–∏—à—ë–ª —Å–µ–≥–º–µ–Ω—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–≥–æ —É –Ω–µ–≥–æ –Ω–µ—Ç?
   –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å, –∏–±–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –Ω–µ—Ç. –í –∏—Å—Ç–æ—Ä–∏—é —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç —Ç–∞–∫–∂–µ –Ω–µ –ø–æ–ø–∞–¥—ë—Ç
3. –ö–∞–∫–æ–π –¥–∞–≤–∞—Ç—å –æ—Ç–≤–µ—Ç, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —é–∑–µ—Ä–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –±–∞–∑–µ?
    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
4. –ù—É–∂–Ω–æ –ª–∏ –±—ã–ª–æ –≤ –¥–æ–ø. –∑–∞–¥–∞–Ω–∏–∏ 1 –ø–æ–ª—É—á–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ 1 —é–∑–µ—Ä—É –∏–ª–∏ –∂–µ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º?
    –†—É—á–∫–∞ –≤—ã–¥–∞—ë—Ç CSV-—Ñ–∞–π–ª —Å –∏—Å—Ç–æ—Ä–∏–µ–π –ø–æ 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç userId, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑ –±–∞–∑—ã